-- client.lua
local serverId = 1
local port = 1234

local function sendRequest(request)
    rednet.open("back")
    rednet.send(serverId, textutils.serialize(request))
    local senderId, response = rednet.receive(port)
    rednet.close()
    return response
end

local function createUser()
    print("Enter username:")
    local username = read()
    local request = {type = "createUser", username = username}
    print(sendRequest(request))
end

local function tweet()
    print("Enter username:")
    local username = read()
    print("Enter tweet:")
    local message = read()
    local request = {type = "tweet", username = username, message = message}
    print(sendRequest(request))
end

local function showProfile()
    print("Enter username:")
    local username = read()
    local request = {type = "showProfile", username = username}
    print(sendRequest(request))
end

local function followUser()
    print("Enter your username:")
    local follower = read()
    print("Enter the username of the person to follow:")
    local followee = read()
    local request = {type = "followUser", follower = follower, followee = followee}
    print(sendRequest(request))
end

local function unfollowUser()
    print("Enter your username:")
    local follower = read()
    print("Enter the username of the person to unfollow:")
    local followee = read()
    local request = {type = "unfollowUser", follower = follower, followee = followee}
    print(sendRequest(request))
end

local function viewTweets()
    print("Enter username:")
    local username = read()
    local request = {type = "viewTweets", username = username}
    print(sendRequest(request))
end

local function updateProfile()
    print("Enter username:")
    local username = read()
    print("Enter new bio:")
    local bio = read()
    print("Enter new profile picture URL:")
    local profilePicture = read()
    local request = {type = "updateProfile", username = username, bio = bio, profilePicture = profilePicture}
    print(sendRequest(request))
end

local function showMenu()
    print("1. Create User")
    print("2. Tweet")
    print("3. View Profile")
    print("4. Follow User")
    print("5. Unfollow User")
    print("6. View Tweets")
    print("7. Update Profile")
    print("8. Exit")
end

while true do
    showMenu()
    local choice = read()

    if choice == "1" then
        createUser()
    elseif choice == "2" then
        tweet()
    elseif choice == "3" then
        showProfile()
    elseif choice == "4" then
        followUser()
    elseif choice == "5" then
        unfollowUser()
    elseif choice == "6" then
        viewTweets()
    elseif choice == "7" then
        updateProfile()
    elseif choice == "8" then
        break
    else
        print("Invalid choice.")
    end
end
